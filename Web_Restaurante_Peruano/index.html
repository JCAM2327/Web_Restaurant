<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sabor del Norte</title>
    <meta name="description" content="Viandas y delivery de aut√©ntica comida peruana en Argentina. Sabor del Norte: Platos t√≠picos, promociones, pedidos online y fidelidad.">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="components.css">
    <link rel="icon" href="img/logo.png">
    <link rel="manifest" href="manifest.json">
    <!-- Google Fonts para el nombre del restaurante -->
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Montserrat:wght@700&display=swap" rel="stylesheet">
    <!-- Google Analytics (ejemplo b√°sico) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-XXXXXXXXXX');
    </script>
</head>
<body>
    <header>
       
        <!-- Sello de fidelidad -->
        <div id="fidelidad" style="position:absolute;top:10px;right:10px;z-index:10;background:#fff3e0;color:#b71c1c;padding:0.5em 1em;border-radius:12px;font-weight:bold;box-shadow:0 2px 8px rgba(0,0,0,0.08);">
            Sello Fidelidad: <span id="sello-count">0</span>/5 ‚≠ê
        </div>
        <div class="carousel-container full-width" style="max-height:180px;">
            <div class="carousel-track" id="carousel-track" style="display:flex;transition:transform 0.5s;">
                <img src="img/carrusel1.jpg" class="carousel-img fade-in" alt="Ceviche peruano fresco" loading="lazy" style="flex:0 0 50%;max-width:50%;">
                <img src="img/carrusel2.jpg" class="carousel-img fade-in" alt="Lomo Saltado tradicional" loading="lazy" style="flex:0 0 50%;max-width:50%;">
                <img src="img/carrusel3.jpg" class="carousel-img fade-in" alt="Causa Lime√±a" loading="lazy" style="flex:0 0 50%;max-width:50%;">
                <img src="img/carrusel4.jpg" class="carousel-img fade-in" alt="Anticuchos" loading="lazy" style="flex:0 0 50%;max-width:50%;">
                <img src="img/carrusel5.jpeg" class="carousel-img fade-in" alt="Papa a la Huanca√≠na" loading="lazy" style="flex:0 0 50%;max-width:50%;">
                <img src="img/carrusel6.jpg" class="carousel-img fade-in" alt="Suspiro Lime√±o" loading="lazy" style="flex:0 0 50%;max-width:50%;">
                <!-- ...puedes a√±adir m√°s im√°genes de comidas o paisajes... -->
            </div>
            <button class="carousel-btn prev" aria-label="Anterior" id="carousel-prev">&#10094;</button>
            <button class="carousel-btn next" aria-label="Siguiente" id="carousel-next">&#10095;</button>
        </div>
        <div class="header-top" style="display:flex;align-items:center;justify-content:center;gap:18px;margin-top:0.5em;">
            <img src="img/bandera-peru.jpg" alt="Bandera Per√∫" class="bandera" style="height:48px;width:auto;">
            <h1 class="titulo-restaurante" style="font-size:2.5em;margin:0 0.5em;letter-spacing:2px;">¬°Sabor del Norte!</h1>
            <img src="img/bandera-argentina.png" alt="Bandera Argentina" class="bandera" style="height:48px;width:auto;">
        </div>
        <div class="aviso-viandas" style="font-size:1em;padding:0.3em 0;">
            <strong>¬°Solo por pedidos y delivery!</strong>
        </div>
        <nav class="navbar">
            <a href="#platos">Platos</a>
            <a href="#promocion">Promociones</a>
            <a href="#contacto">Contacto</a>
            <a href="#pedido" class="pedido-btn">¬°Haz tu pedido!</a>
            <button id="faq-toggle-btn" style="background:none;border:none;color:#b71c1c;font-weight:bold;font-size:1.1em;cursor:pointer;padding:0.3em 1em;border-radius:8px;">Preguntas Frecuentes ‚ñº</button>
        </nav>
        <button id="modo-nocturno-btn" style="position:absolute;top:10px;left:10px;z-index:10;background:#ffd600;color:#b71c1c;border:none;border-radius:8px;padding:0.3em 0.7em;width:38px;height:38px;font-size:1.3em;display:flex;align-items:center;justify-content:center;">üåô</button>
        <button id="carrito-toggle-btn" class="fab-btn icon-btn" style="position:absolute;top:10px;left:60px;z-index:11;width:38px;height:38px;font-size:1.3em;display:flex;align-items:center;justify-content:center;">
            üõí
            <span id="carrito-count" style="position:absolute;top:-8px;right:-8px;background:#b71c1c;color:#fff;font-size:0.85em;border-radius:50%;width:22px;height:22px;display:flex;align-items:center;justify-content:center;">0</span>
        </button>
      
    </header>

    <!-- Sugerencia del Chef -->
    <section id="chef-sugerencia" style="background:#fff3e0;padding:1em 0;text-align:center;margin-bottom:1em;">
        <h2>‚≠ê Sugerencia del Chef</h2>
        <div id="chef-plato" style="font-size:1.2em;">
            Hoy te recomendamos: <strong>Aj√≠ de Gallina</strong> - Un cl√°sico cremoso y lleno de sabor del norte peruano.
        </div>
        <small style="color:#b71c1c;">¬°Descubre cada semana una nueva sugerencia!</small>
    </section>

    <!-- Mapa interactivo -->
    <section id="mapa-peru" style="text-align:center;margin-bottom:1em;">
        <h2>Origen de Nuestros Platos</h2>
        <div style="max-width:700px;margin:0 auto 1em auto;text-align:left;">
            <p class="desc-mapa-peru">
                Per√∫ es un pa√≠s de gran diversidad geogr√°fica y cultural, lo que se refleja en su gastronom√≠a. Desde la costa norte, famosa por sus ceviches y pescados frescos, pasando por la sierra con sus guisos y papas, hasta la selva con sabores ex√≥ticos y √∫nicos. Cada plato t√≠pico cuenta una historia y representa una regi√≥n, una tradici√≥n y una mezcla de culturas ancestrales y modernas.
            </p>
        </div>
        <div style="position:relative;display:inline-block;">
            <img src="img/mapa-peru.avif" alt="Mapa de Per√∫ con regiones" style="max-width:320px;width:100%;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,0.08);" id="mapa-peru-img">
            <div id="tooltip-mapa" style="display:none;position:absolute;top:10px;left:10px;background:#fff3e0;color:#b71c1c;padding:0.5em 1em;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.10);font-size:0.95em;z-index:10;"></div>
            <!-- Leyenda de colores sobre la imagen -->
            <div style="position:absolute;bottom:10px;left:10px;z-index:11;display:flex;gap:10px;">
                <div style="display:flex;align-items:center;gap:4px;">
                    <span style="display:inline-block;width:18px;height:18px;background:#ff9800;border-radius:4px;border:1px solid #b71c1c;"></span>
                    <span style="font-size:0.98em;background:#fff3e0;border-radius:6px;padding:2px 7px;color:#b71c1c;">Costa</span>
                </div>
                <div style="display:flex;align-items:center;gap:4px;">
                    <span style="display:inline-block;width:18px;height:18px;background:#ffd600;border-radius:4px;border:1px solid #b71c1c;"></span>
                    <span style="font-size:0.98em;background:#fff3e0;border-radius:6px;padding:2px 7px;color:#b71c1c;">Sierra</span>
                </div>
                <div style="display:flex;align-items:center;gap:4px;">
                    <span style="display:inline-block;width:18px;height:18px;background:#d32f2f;border-radius:4px;border:1px solid #b71c1c;"></span>
                    <span style="font-size:0.98em;background:#fff3e0;border-radius:6px;padding:2px 7px;color:#b71c1c;">Selva</span>
                </div>
            </div>
        </div>
        <div id="desc-region" class="desc-region" style="margin:1em auto 0 auto;max-width:400px;font-size:1.05em;color:#b71c1c;min-height:48px;text-align:center;transition:color 0.3s;">
            Pasa el mouse sobre el mapa para descubrir la regi√≥n de cada plato.
        </div>
    </section>

    <!-- Test "¬øQu√© plato peruano eres?" -->
    <section style="text-align:center;margin-bottom:1em;">
        <button id="test-plato-btn" style="background:#b71c1c;color:#fff;padding:0.7em 1.5em;border:none;border-radius:12px;font-size:1.1em;cursor:pointer;">
            ¬øQu√© plato peruano eres? ¬°Haz el test!
        </button>
    </section>

    <!-- Elimina la secci√≥n <section id="faq">... </section> que estaba visible -->
    <div id="faq-modal" class="modal-bg">
        <div class="modal-content faq-content">
            <h2 style="color:#b71c1c;text-align:center;">Preguntas Frecuentes</h2>
            <input id="faq-search" type="text" placeholder="Buscar pregunta...">
            <div id="faq-list">
                <!-- ...preguntas frecuentes existentes... -->
            </div>
            <div style="text-align:center;margin-top:1em;">
                <button onclick="document.getElementById('faq-modal').style.display='none'" style="background:#b71c1c;color:#fff;padding:0.6em 1.5em;border:none;border-radius:10px;cursor:pointer;">Cerrar</button>
            </div>
        </div>
    </div>

    <section id="promocion">
        <div class="promo-banner">
            <span id="promo-text">¬°Este viernes porciones gratis de papas con tu pedido!</span>
            <span id="cuenta-regresiva" style="margin-left:1em;color:#b71c1c;font-weight:bold;"></span>
            <button id="vale-descuento-btn">Obtener Vale de Descuento</button>
        </div>
    </section>

    <section id="platos">
        <h2>Platos T√≠picos</h2>
        <div class="platos-grid">
            <!-- Tarjetas de platos -->
            <div class="plato-card fade-in" tabindex="0" aria-label="Ceviche. Fresco pescado marinado en lim√≥n, cebolla y aj√≠.">
                <img src="img/ceviche.jpg" alt="Ceviche peruano" loading="lazy">
                <h3>Ceviche</h3>
                <p>Fresco pescado marinado en lim√≥n, cebolla y aj√≠.</p>
                <span class="precio">$13.500</span>
                <button class="pedido-btn" aria-label="Pedir Ceviche">Pedir</button>
            </div>
            <div class="plato-card fade-in" tabindex="0" aria-label="Lomo Saltado. Salteado de carne, papas y verduras al estilo peruano.">
                <img src="img/lomo.jpg" alt="Lomo Saltado peruano" loading="lazy">
                <h3>Lomo Saltado</h3>
                <p>Salteado de carne, papas y verduras al estilo peruano.</p>
                <span class="precio">$15.000</span>
                <button class="pedido-btn" aria-label="Pedir Lomo Saltado">Pedir</button>
            </div>
            <div class="plato-card">
                <img src="img/anticuchos.jpg" alt="Anticuchos">
                <h3>Anticuchos</h3>
                <p>Brochetas de coraz√≥n de res con salsa especial.</p>
                <span class="precio">$12.000</span>
                <button class="pedido-btn">Pedir</button>
            </div>
            <div class="plato-card">
                <img src="img/aji-de-gallina.jpeg" alt="Aj√≠ de Gallina">
                <h3>Aj√≠ de Gallina</h3>
                <p>Pollo deshilachado en salsa cremosa de aj√≠ amarillo y nueces.</p>
                <span class="precio">$13.000</span>
                <button class="pedido-btn">Pedir</button>
            </div>
            <div class="plato-card">
                <img src="img/tacu-tacu.jpeg" alt="Tacu Tacu">
                <h3>Tacu Tacu</h3>
                <p>Mezcla de arroz y frejoles dorados, acompa√±ado de salsa criolla.</p>
                <span class="precio">$12.500</span>
                <button class="pedido-btn">Pedir</button>
            </div>
            <div class="plato-card">
                <img src="img/arroz-chaufa.jpg" alt="Arroz Chaufa">
                <h3>Arroz Chaufa</h3>
                <p>Arroz salteado al estilo chino-peruano con pollo y verduras.</p>
                <span class="precio">$14.000</span>
                <button class="pedido-btn" aria-label="Pedir Arroz Chaufa">Pedir</button>
            </div>
            <!-- ...puedes a√±adir m√°s platos... -->
        </div>
    </section>

    <section id="contacto-comentarios" style="display:flex;justify-content:center;align-items:flex-start;gap:0.5em;flex-wrap:wrap;margin-bottom:2em;">
        <div id="contacto" style="flex:1 1 320px;max-width:400px;min-width:260px;background:#fff3e0;border-radius:14px;padding:1.2em 1em;box-shadow:0 2px 8px rgba(0,0,0,0.06);">
            <h2 style="color:#b71c1c;">Contacto</h2>
            <form id="contact-form" novalidate>
                <input type="text" name="nombre" placeholder="Tu nombre" required aria-required="true" style="margin-bottom:0.7em;">
                <input type="email" name="email" placeholder="Tu correo" required aria-required="true" style="margin-bottom:0.7em;">
                <textarea name="mensaje" placeholder="Tu mensaje" required aria-required="true" style="margin-bottom:0.7em;"></textarea>
                <div id="form-error" style="color:#b71c1c;display:none;margin-bottom:0.5em;"></div>
                <button type="submit" style="background:#b71c1c;color:#fff;border:none;border-radius:8px;padding:0.7em;font-size:1em;cursor:pointer;">Enviar</button>
            </form>
            <div class="contact-logos" style="margin-top:1em; display:flex; justify-content:center; gap:18px;">
                <a href="https://wa.me/542235023826" target="_blank" title="WhatsApp">
                    <img src="img/whatsapp.jpeg" alt="WhatsApp" style="height:32px;width:32px;">
                </a>
                <a href="#" title="Instagram">
                    <img src="img/instagram.jpeg" alt="Instagram" style="height:32px;width:32px;">
                </a>
            </div>
        </div>
        <div class="valoraciones" style="flex:1 1 320px;max-width:400px;min-width:260px;background:#fff3e0;border-radius:14px;padding:1.2em 1em;box-shadow:0 2px 8px rgba(0,0,0,0.06);">
            <label for="valoracion-select" style="color:#b71c1c;font-weight:bold;">Califica tu experiencia:</label>
            <select id="valoracion-select" style="margin-bottom:0.7em;">
                <option value="">Selecciona</option>
                <option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê Excelente</option>
                <option value="4">‚≠ê‚≠ê‚≠ê‚≠ê Muy bueno</option>
                <option value="3">‚≠ê‚≠ê‚≠ê Bueno</option>
                <option value="2">‚≠ê‚≠ê Regular</option>
                <option value="1">‚≠ê Malo</option>
            </select>
            <textarea id="comentario-input" placeholder="Deja tu comentario..." style="margin-bottom:0.7em;"></textarea>
            <button id="enviar-valoracion" style="background:#b71c1c;color:#fff;border:none;border-radius:8px;padding:0.7em 1em;cursor:pointer;">Enviar</button>
            <div id="valoraciones-lista"></div>
        </div>
    </section>

    <footer>
        <p>&copy; 2025 Jos√© Mondrag√≥n</p>
        <p>Todos los derechos reservados.</p>
        <div class="footer-aviso">
            <strong>¬°Solo delivery! Ped√≠ tu vianda peruana ahora.</strong>
        </div>
        <div style="margin-top:1em;">
            <a href="privacidad.html" style="color:#b71c1c;text-decoration:underline;">Pol√≠tica de Privacidad</a>
        </div>
    </footer>

    <a href="https://wa.me/542235023826?text=Quiero%20el%20men√∫%20del%20d√≠a%20por%20favor!" target="_blank" id="pedido-express"
       style="position:fixed;bottom:100px;right:20px;z-index:1000;background:#25d366;color:#fff;padding:0.8em 1.2em;border-radius:50px;box-shadow:0 2px 8px rgba(0,0,0,0.15);font-weight:bold;display:flex;align-items:center;gap:0.5em;text-decoration:none;">
        <img src="img/whatsapp.jpeg" alt="WhatsApp" style="height:24px;width:24px;"> Pedido Express
    </a>
    <div id="pedido-express-aviso" style="position:fixed;bottom:75px;right:20px;z-index:1001;background:#fff3e0;color:#b71c1c;padding:0.4em 1em;border-radius:10px;box-shadow:0 2px 8px rgba(0,0,0,0.10);font-size:0.98em;">
        <!-- <span style="font-weight:bold;">Nota:</span> El Pedido Express tiene un peque√±o recargo por prioridad de atenci√≥n. -->
    </div>

    <!-- Rueda de la Suerte -->
    <button id="rueda-btn" style="position:fixed;bottom:30px;right:30px;z-index:1000;background:#ffd600;color:#b71c1c;border:none;border-radius:50%;width:60px;height:60px;font-size:2em;box-shadow:0 2px 8px rgba(0,0,0,0.15);cursor:pointer;">
        üéÅ
    </button>
    <div id="rueda-modal" class="modal-bg">
        <div id="rueda-modal-content" class="modal-content rueda-content">
            <h2 style="color:inherit;">¬°Rueda de la Suerte!</h2>
            <p style="color:inherit;">Gir√° y gan√° premios: descuentos, postres gratis o env√≠o sin cargo.</p>
            <button id="girar-rueda" style="background:#b71c1c;color:#fff;padding:0.7em 1.5em;border:none;border-radius:12px;font-size:1.1em;cursor:pointer;">Girar</button>
            <div id="resultado-rueda" style="margin-top:1em;font-weight:bold;color:#b71c1c;"></div>
            <button onclick="document.getElementById('rueda-modal').style.display='none'" style="margin-top:1em;background:#ffd600;color:#b71c1c;border:none;border-radius:8px;padding:0.5em 1em;cursor:pointer;">Cerrar</button>
        </div>
    </div>

    <!-- Test Modal -->
    <div id="test-modal" class="modal-bg">
        <div class="modal-content test-content">
            <h2>¬øQu√© plato peruano eres?</h2>
            <div id="test-content">
                <p>¬øPrefieres algo fresco, caliente o picante?</p>
                <button onclick="mostrarResultadoTest('Ceviche')" style="margin:0.5em;">Fresco</button>
                <button onclick="mostrarResultadoTest('Lomo Saltado')" style="margin:0.5em;">Caliente</button>
                <button onclick="mostrarResultadoTest('Aj√≠ de Gallina')" style="margin:0.5em;">Picante</button>
            </div>
            <div id="test-resultado" style="margin-top:1em;font-weight:bold;color:#b71c1c;"></div>
            <button onclick="document.getElementById('test-modal').style.display='none'" style="margin-top:1em;background:#ffd600;color:#b71c1c;border:none;border-radius:8px;padding:0.5em 1em;cursor:pointer;">Cerrar</button>
        </div>
    </div>

    <!-- 1. Carrito de pedidos: Bot√≥n flotante y modal -->
    <button id="carrito-toggle-btn" class="fab-btn carrito-fab">üõí</button>
    <div id="carrito-modal" class="modal-bg">
        <div class="carrito-content modal-content">
            <h2>Tu Pedido</h2>
            <ul id="carrito-lista"></ul>
            <div id="carrito-total"></div>
            <div id="cupon-section">
                <input type="text" id="cupon-input" placeholder="Cup√≥n de descuento">
                <button id="cupon-aplicar">Aplicar</button>
                <div id="cupon-msg" style="margin-top:0.5em;font-size:0.95em;"></div>
            </div>
            <button id="carrito-agregar" style="background:#ffd600;color:#b71c1c;border:none;border-radius:8px;padding:0.7em 1.2em;margin-top:1em;cursor:pointer;">Agregar otro pedido</button>
            <button id="carrito-enviar">Enviar Pedido</button>
            <button class="vaciar-btn" id="carrito-vaciar">Vaciar</button>
            <button onclick="document.getElementById('carrito-modal').style.display='none'">Cerrar</button>
        </div>
    </div>

    <!-- 2. Notificaciones push -->
    <button id="push-btn" class="fab-btn push-fab" title="Activa notificaciones de promos">üîî Activar Notificaciones</button>

    
  

    <!-- 14. Chat de soporte -->
    <div id="chat-soporte" class="chat-modal" style="display:none;">
        <div id="chat-header">
            Soporte en l√≠nea
            <button onclick="document.getElementById('chat-soporte').style.display='none'" style="float:right;background:none;border:none;color:#fff;font-size:1.2em;cursor:pointer;">√ó</button>
        </div>
        <div id="chat-mensajes" style="min-height:80px;"></div>
        <div id="chat-input-area">
            <input id="chat-input" type="text" placeholder="Escribe tu mensaje...">
            <button id="chat-enviar">Enviar</button>
        </div>
        <div style="font-size:0.95em;color:#888;text-align:center;margin-top:0.5em;">
            Tambi√©n puedes escribirnos por WhatsApp para soporte inmediato.
        </div>
    </div>

    <!-- 15. Modo offline aviso -->
    <div id="offline-aviso">Est√°s sin conexi√≥n. Algunas funciones pueden no estar disponibles.</div>

    <script src="main.js"></script>
    <script src="components.js"></script>
    <script>
    // Modo nocturno
    document.getElementById('modo-nocturno-btn').onclick = function() {
        document.body.classList.toggle('modo-nocturno');
    };

    // Rueda de la Suerte
    document.getElementById('rueda-btn').onclick = function() {
        document.getElementById('rueda-modal').style.display = 'flex';
    };
    document.getElementById('girar-rueda').onclick = function() {
        const premios = [
            '10% de descuento en tu pedido',
            'Postre gratis',
            'Env√≠o sin cargo',
            'Vale 2x1 para tu pr√≥xima vianda',
            '¬°Sigue participando!'
        ];
        const premio = premios[Math.floor(Math.random() * premios.length)];
        document.getElementById('resultado-rueda').innerText = premio;
    };

    // Test plato peruano
    document.getElementById('test-plato-btn').onclick = function() {
        document.getElementById('test-modal').style.display = 'flex';
        document.getElementById('test-resultado').innerText = '';
    };
    window.mostrarResultadoTest = function(plato) {
        document.getElementById('test-resultado').innerText = '¬°Eres ' + plato + '! Te recomendamos pedirlo hoy.';
    };

    // Sello de fidelidad (simulado)
    let sellos = 0;
    document.querySelectorAll('.pedido-btn').forEach(btn => {
        btn.addEventListener('click', () => {
            sellos++;
            document.getElementById('sello-count').innerText = sellos;
            if (sellos >= 5) {
                alert('¬°Felicitaciones! Has ganado una vianda gratis por fidelidad.');
                sellos = 0;
                document.getElementById('sello-count').innerText = sellos;
            }
        });
    });

    // Cuenta regresiva para promo
    function actualizarCuentaRegresiva() {
        const promoDate = new Date();
        promoDate.setDate(promoDate.getDate() + ((5 - promoDate.getDay() + 7) % 7)); // pr√≥ximo viernes
        promoDate.setHours(0,0,0,0);
        const now = new Date();
        const diff = promoDate - now;
        if (diff > 0) {
            const dias = Math.floor(diff / (1000*60*60*24));
            const horas = Math.floor((diff/(1000*60*60))%24);
            const minutos = Math.floor((diff/(1000*60))%60);
            document.getElementById('cuenta-regresiva').innerText = `Faltan ${dias}d ${horas}h ${minutos}m`;
        } else {
            document.getElementById('cuenta-regresiva').innerText = '';
        }
    }
    setInterval(actualizarCuentaRegresiva, 60000);
    actualizarCuentaRegresiva();

    // Validaci√≥n de formulario y feedback visual
    document.getElementById('contact-form').onsubmit = function(e) {
        e.preventDefault();
        var nombre = this.nombre.value.trim();
        var email = this.email.value.trim();
        var mensaje = this.mensaje.value.trim();
        var error = "";
        if (!nombre) error = "Por favor ingresa tu nombre.";
        else if (!email || !/^[^@]+@[^@]+\.[a-z]{2,}$/i.test(email)) error = "Correo inv√°lido.";
        else if (!mensaje) error = "Por favor ingresa tu mensaje.";
        if (error) {
            document.getElementById('form-error').innerText = error;
            document.getElementById('form-error').style.display = "block";
            return false;
        }
        document.getElementById('form-error').style.display = "none";
        alert("¬°Gracias por contactarnos! Te responderemos pronto.");
        this.reset();
    };

    // Feedback visual al pedir
    document.querySelectorAll('.pedido-btn').forEach(btn => {
        btn.addEventListener('click', function(e) {
            e.preventDefault();
            let card = btn.closest('.plato-card');
            let nombre = card.querySelector('h3').innerText;
            let precio = parseInt(card.querySelector('.precio').innerText.replace(/\D/g, ''));
            carrito.push({nombre, precio});
            actualizarCarrito();
            card.classList.add('pedido-ok');
            setTimeout(() => card.classList.remove('pedido-ok'), 1200);
            // No abrir WhatsApp, solo agregar al carrito
            document.getElementById('carrito-modal').style.display = 'flex';
        });
    });

    // Mapa interactivo (tooltip simple y descripci√≥n din√°mica)
    const mapa = document.getElementById('mapa-peru-img');
    const tooltip = document.getElementById('tooltip-mapa');
    const descRegion = document.getElementById('desc-region');
    if (mapa) {
        mapa.addEventListener('mousemove', function(e) {
            let x = e.offsetX / mapa.offsetWidth;
            let region = "Costa Norte";
            let descripcion = "Ceviche, arroz con mariscos, tiraditos y pescados frescos.";
            if (x < 0.33) {
                region = "Costa Norte";
                descripcion = "Ceviche, arroz con mariscos, tiraditos y pescados frescos.";
            } else if (x < 0.66) {
                region = "Sierra";
                descripcion = "Aj√≠ de gallina, papa a la huanca√≠na, rocoto relleno, guisos y papas andinas.";
            } else {
                region = "Selva";
                descripcion = "Tacacho con cecina, juane, platos con pl√°tano y sabores ex√≥ticos de la Amazon√≠a.";
            }
            tooltip.innerHTML = `<strong>${region}</strong>`;
            tooltip.style.display = "block";
            tooltip.style.left = (e.offsetX + 10) + "px";
            tooltip.style.top = (e.offsetY + 10) + "px";
            descRegion.innerHTML = `<strong>${region}:</strong> ${descripcion}`;
        });
        mapa.addEventListener('mouseleave', function() {
            tooltip.style.display = "none";
            descRegion.innerHTML = "Pasa el mouse sobre el mapa para descubrir la regi√≥n de cada plato.";
        });
    }

    // Preguntas Frecuentes: filtros r√°pidos y buscador funcional
    // (Reinserta los botones de filtro si no existen)
    if (!document.getElementById('faq-filtros')) {
        const faqFiltros = [
            { label: "Pedidos", keywords: ["pedido", "pedidos", "haz tu pedido"] },
            { label: "Env√≠os", keywords: ["env√≠o", "delivery", "domicilio"] },
            { label: "Pagos", keywords: ["pago", "pagos", "mercado pago", "efectivo", "transferencia"] },
            { label: "Fidelidad", keywords: ["fidelidad", "sello", "vianda gratis"] },
            { label: "Alergias", keywords: ["alergia", "alergias", "ingredientes"] }
        ];
        const filtroFaqContainer = document.createElement('div');
        filtroFaqContainer.id = 'faq-filtros';
        filtroFaqContainer.style.display = 'flex';
        filtroFaqContainer.style.flexWrap = 'wrap';
        filtroFaqContainer.style.gap = '0.5em';
        filtroFaqContainer.style.justifyContent = 'center';
        faqFiltros.forEach(f => {
            const btn = document.createElement('button');
            btn.type = 'button';
            btn.innerText = f.label;
            btn.style.background = '#ffd600';
            btn.style.color = '#b71c1c';
            btn.style.border = 'none';
            btn.style.borderRadius = '8px';
            btn.style.padding = '0.4em 1em';
            btn.style.cursor = 'pointer';
            btn.onclick = () => {
                document.getElementById('faq-search').value = f.keywords[0];
                const faqPreguntas = Array.from(document.querySelectorAll('#faq-modal .faq-item'));
                faqPreguntas.forEach(item => {
                    item.style.display = f.keywords.some(k => item.innerText.toLowerCase().includes(k)) ? '' : 'none';
                });
            };
            filtroFaqContainer.appendChild(btn);
        });
        const faqSearch = document.getElementById('faq-search');
        faqSearch.parentNode.insertBefore(filtroFaqContainer, faqSearch.nextSibling);
    }
    document.getElementById('faq-search').oninput = function() {
        const val = this.value.toLowerCase();
        const faqPreguntas = Array.from(document.querySelectorAll('#faq-modal .faq-item'));
        faqPreguntas.forEach(item => {
            item.style.display = item.innerText.toLowerCase().includes(val) ? '' : 'none';
        });
    };

    // Service Worker para PWA
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('sw.js');
    }

    // Carrusel funcional (2 im√°genes visibles, avance de 2 en 2, bucle)
    (function() {
        const track = document.getElementById('carousel-track');
        const images = track.querySelectorAll('img');
        const prevBtn = document.getElementById('carousel-prev');
        const nextBtn = document.getElementById('carousel-next');
        let current = 0;
        const visible = 2;
        function updateCarousel() {
            const total = images.length;
            let offset = (current * 50); // 50% por imagen
            track.style.transform = `translateX(-${offset}%)`;
        }
        prevBtn.onclick = function() {
            const total = images.length;
            current = (current - visible + total) % total;
            updateCarousel();
        };
        nextBtn.onclick = function() {
            const total = images.length;
            current = (current + visible) % total;
            updateCarousel();
        };
        // Responsive: si hay menos de 2 im√°genes, oculta botones
        if (images.length <= 2) {
            prevBtn.style.display = 'none';
            nextBtn.style.display = 'none';
        }
        // Auto-avance cada 6s
        setInterval(() => {
            nextBtn.click();
        }, 6000);
        updateCarousel();
    })();

    // 1. Carrito de pedidos
    let carrito = [];
    function actualizarCarrito() {
        const lista = document.getElementById('carrito-lista');
        lista.innerHTML = '';
        let total = 0;
        carrito.forEach((item, i) => {
            total += item.precio;
            const li = document.createElement('li');
            li.innerHTML = `${item.nombre} <span>$${item.precio.toLocaleString()}</span> <button onclick="carritoEliminar(${i})" style="background:none;border:none;color:#b71c1c;cursor:pointer;">‚úñ</button>`;
            lista.appendChild(li);
        });
        document.getElementById('carrito-total').innerText = 'Total: $' + total.toLocaleString();
    }
    function carritoEliminar(idx) {
        carrito.splice(idx, 1);
        actualizarCarrito();
    }
    document.querySelectorAll('.pedido-btn').forEach(btn => {
        btn.addEventListener('click', function(e) {
            e.preventDefault();
            let card = btn.closest('.plato-card');
            let nombre = card.querySelector('h3').innerText;
            let precio = parseInt(card.querySelector('.precio').innerText.replace(/\D/g, ''));
            carrito.push({nombre, precio});
            actualizarCarrito();
            card.classList.add('pedido-ok');
            setTimeout(() => card.classList.remove('pedido-ok'), 1200);
            // No abrir WhatsApp, solo agregar al carrito
            document.getElementById('carrito-modal').style.display = 'flex';
        });
    });
    document.getElementById('carrito-toggle-btn').onclick = function() {
        document.getElementById('carrito-modal').style.display = 'flex';
        actualizarCarrito();
    };
    document.getElementById('carrito-vaciar').onclick = function() {
        carrito = [];
        actualizarCarrito();
    };
    document.getElementById('carrito-enviar').onclick = function() {
        if (carrito.length === 0) return alert('El carrito est√° vac√≠o.');
        alert('¬°Pedido enviado! Nos contactaremos por WhatsApp.');
        carrito = [];
        actualizarCarrito();
        document.getElementById('carrito-modal').style.display = 'none';
    };

    // 2. Notificaciones push (simulado)
    document.getElementById('push-btn').onclick = function() {
        alert('¬°Notificaciones activadas! Te avisaremos de nuevas promos.');
    };

    // 6. Valoraciones y comentarios
    let valoraciones = [];
    document.getElementById('enviar-valoracion').onclick = function() {
        const val = document.getElementById('valoracion-select').value;
        const com = document.getElementById('comentario-input').value.trim();
        if (!val) return alert('Selecciona una calificaci√≥n.');
        valoraciones.push({val, com});
        mostrarValoraciones();
        document.getElementById('valoracion-select').value = '';
        document.getElementById('comentario-input').value = '';
    };
    function mostrarValoraciones() {
        const lista = document.getElementById('valoraciones-lista');
        lista.innerHTML = '';
        valoraciones.slice(-5).reverse().forEach(v => {
            const div = document.createElement('div');
            div.className = 'comentario';
            div.innerHTML = `<span>${'‚≠ê'.repeat(v.val)}</span> ${v.com}`;
            lista.appendChild(div);
        });
    }

    // 7. Filtro de platos
    document.getElementById('filtro-region').onchange =
    document.getElementById('filtro-tipo').onchange =
    document.getElementById('filtro-busqueda').oninput = function() {
        const region = document.getElementById('filtro-region').value.toLowerCase();
        const tipo = document.getElementById('filtro-tipo').value.toLowerCase();
        const busq = document.getElementById('filtro-busqueda').value.toLowerCase();
        document.querySelectorAll('.plato-card').forEach(card => {
            let nombre = card.querySelector('h3').innerText.toLowerCase();
            let show = true;
            if (region && !card.innerHTML.toLowerCase().includes(region)) show = false;
            if (tipo && !card.innerHTML.toLowerCase().includes(tipo)) show = false;
            if (busq && !nombre.includes(busq)) show = false;
            card.style.display = show ? '' : 'none';
        });
    };

    // 8. Accesibilidad: foco visible (ya en CSS)

    // 10. Animaciones suaves (ya en CSS)

    // 11. Preguntas frecuentes din√°micas (buscador)
    const faqPreguntas = Array.from(document.querySelectorAll('#faq-modal .faq-item'));
    document.getElementById('faq-search').oninput = function() {
        const val = this.value.toLowerCase();
        faqPreguntas.forEach(item => {
            item.style.display = item.innerText.toLowerCase().includes(val) ? '' : 'none';
        });
    };

    // 12. Soporte para cupones
    document.getElementById('cupon-aplicar').onclick = function() {
        const cupon = document.getElementById('cupon-input').value.trim().toUpperCase();
        let msg = '';
        if (cupon === 'PERU10') {
            msg = '¬°Cup√≥n aplicado! 10% de descuento en tu pedido.';
            // Aplica descuento visual (no real, demo)
            let total = carrito.reduce((acc, item) => acc + item.precio, 0);
            total = Math.round(total * 0.9);
            document.getElementById('carrito-total').innerText = 'Total: $' + total.toLocaleString();
        } else if (cupon) {
            msg = 'Cup√≥n no v√°lido.';
        }
        document.getElementById('cupon-msg').innerText = msg;
    };

    // 14. Chat de soporte (simulado)
    document.getElementById('chat-toggle-btn').onclick = function() {
        document.getElementById('chat-soporte').style.display = 'flex';
    };
    document.getElementById('chat-enviar').onclick = function() {
        const input = document.getElementById('chat-input');
        const msg = input.value.trim();
        if (!msg) return;
        const chat = document.getElementById('chat-mensajes');
        const div = document.createElement('div');
        div.innerHTML = `<b>T√∫:</b> ${msg}`;
        chat.appendChild(div);
        input.value = '';
        setTimeout(() => {
            const bot = document.createElement('div');
            bot.innerHTML = `<b>Soporte:</b> ¬°Gracias por tu mensaje! Te responderemos pronto.`;
            chat.appendChild(bot);
            chat.scrollTop = chat.scrollHeight;
        }, 800);
    };

    // 15. Modo offline (aviso)
    window.addEventListener('offline', () => {
        document.getElementById('offline-aviso').style.display = 'block';
    });
    window.addEventListener('online', () => {
        document.getElementById('offline-aviso').style.display = 'none';
    });

    // Bot√≥n modo nocturno (corregido)
    document.getElementById('modo-nocturno-btn').addEventListener('click', function() {
        document.body.classList.toggle('modo-nocturno');
        // Guarda preferencia en localStorage
        if (document.body.classList.contains('modo-nocturno')) {
            localStorage.setItem('modoNocturno', '1');
        } else {
            localStorage.removeItem('modoNocturno');
        }
    });
    // Aplica modo nocturno si estaba guardado
    if (localStorage.getItem('modoNocturno') === '1') {
        document.body.classList.add('modo-nocturno');
    }
    </script>
</body>
</html>
